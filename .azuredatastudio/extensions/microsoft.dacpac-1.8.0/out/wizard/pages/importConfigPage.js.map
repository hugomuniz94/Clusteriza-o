{"version":3,"file":"importConfigPage.js","sourceRoot":"../../../src","sources":["wizard/pages/importConfigPage.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the Source EULA. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as azdata from 'azdata';\nimport * as vscode from 'vscode';\nimport * as loc from '../../localizedConstants';\nimport { DacFxDataModel } from '../api/models';\nimport { DataTierApplicationWizard } from '../dataTierApplicationWizard';\nimport { DacFxConfigPage } from '../api/dacFxConfigPage';\nimport { generateDatabaseName } from '../api/utils';\n\nexport class ImportConfigPage extends DacFxConfigPage {\n\tprivate form: azdata.FormContainer;\n\tpublic selectionPromise: Promise<void>;\n\n\tpublic constructor(instance: DataTierApplicationWizard, wizardPage: azdata.window.WizardPage, model: DacFxDataModel, view: azdata.ModelView) {\n\t\tsuper(instance, wizardPage, model, view);\n\t\tthis.fileExtension = '.bacpac';\n\t}\n\n\tasync start(): Promise<boolean> {\n\t\tlet databaseComponent = await this.createDatabaseTextBox(loc.targetDatabase);\n\t\tlet serverComponent = await this.createServerDropdown(true);\n\t\tlet fileBrowserComponent = await this.createFileBrowser();\n\n\t\tthis.form = this.view.modelBuilder.formContainer()\n\t\t\t.withFormItems(\n\t\t\t\t[\n\t\t\t\t\tfileBrowserComponent,\n\t\t\t\t\tserverComponent,\n\t\t\t\t\tdatabaseComponent,\n\t\t\t\t], {\n\t\t\t\thorizontal: true,\n\t\t\t\tcomponentWidth: 400\n\t\t\t}).component();\n\t\tawait this.view.initializeModel(this.form);\n\t\treturn true;\n\t}\n\n\tasync onPageEnter(): Promise<boolean> {\n\t\tlet r1 = await this.populateServerDropdown();\n\t\t// get existing database values to verify if new database name is valid\n\t\tawait this.getDatabaseValues();\n\t\treturn r1;\n\t}\n\n\tprivate async createFileBrowser(): Promise<azdata.FormComponent> {\n\t\tthis.createFileBrowserParts();\n\n\t\tthis.fileButton.onDidClick(async (click) => { this.selectionPromise = this.handleFileSelection(); });\n\n\t\tthis.fileTextBox.onTextChanged(async () => {\n\t\t\tthis.model.filePath = this.fileTextBox.value;\n\t\t\tthis.model.database = generateDatabaseName(this.model.filePath);\n\t\t\tthis.databaseTextBox.value = this.model.database;\n\t\t});\n\n\t\treturn {\n\t\t\tcomponent: this.fileTextBox,\n\t\t\ttitle: loc.fileLocation,\n\t\t\tactions: [this.fileButton]\n\t\t};\n\t}\n\n\tprivate async handleFileSelection(): Promise<void> {\n\t\tlet fileUris = await vscode.window.showOpenDialog(\n\t\t\t{\n\t\t\t\tcanSelectFiles: true,\n\t\t\t\tcanSelectFolders: false,\n\t\t\t\tcanSelectMany: false,\n\t\t\t\tdefaultUri: vscode.Uri.file(this.getRootPath()),\n\t\t\t\topenLabel: loc.open,\n\t\t\t\tfilters: {\n\t\t\t\t\t'bacpac Files': ['bacpac'],\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\tif (!fileUris || fileUris.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tlet fileUri = fileUris[0];\n\t\tthis.fileTextBox.value = fileUri.fsPath;\n\t\tthis.model.filePath = fileUri.fsPath;\n\t\tthis.model.database = generateDatabaseName(this.model.filePath);\n\t\tthis.databaseTextBox.value = this.model.database;\n\t}\n}\n"]}