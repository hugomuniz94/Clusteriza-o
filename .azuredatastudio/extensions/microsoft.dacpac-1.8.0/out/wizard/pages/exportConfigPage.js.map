{"version":3,"file":"exportConfigPage.js","sourceRoot":"../../../src","sources":["wizard/pages/exportConfigPage.ts"],"names":[],"mappings":"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","sourcesContent":["/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the Source EULA. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n\nimport * as azdata from 'azdata';\nimport * as vscode from 'vscode';\nimport * as loc from '../../localizedConstants';\nimport { DacFxDataModel } from '../api/models';\nimport { DataTierApplicationWizard } from '../dataTierApplicationWizard';\nimport { DacFxConfigPage } from '../api/dacFxConfigPage';\n\nexport class ExportConfigPage extends DacFxConfigPage {\n\tprivate form: azdata.FormContainer;\n\n\tpublic constructor(instance: DataTierApplicationWizard, wizardPage: azdata.window.WizardPage, model: DacFxDataModel, view: azdata.ModelView) {\n\t\tsuper(instance, wizardPage, model, view);\n\t\tthis.fileExtension = '.bacpac';\n\t}\n\n\tasync start(): Promise<boolean> {\n\t\tlet databaseComponent = await this.createDatabaseDropdown();\n\t\tlet serverComponent = await this.createServerDropdown(false);\n\t\tlet fileBrowserComponent = await this.createFileBrowser();\n\n\t\tthis.form = this.view.modelBuilder.formContainer()\n\t\t\t.withFormItems(\n\t\t\t\t[\n\t\t\t\t\tserverComponent,\n\t\t\t\t\tdatabaseComponent,\n\t\t\t\t\tfileBrowserComponent,\n\t\t\t\t], {\n\t\t\t\thorizontal: true,\n\t\t\t\tcomponentWidth: 400\n\t\t\t}).component();\n\t\tawait this.view.initializeModel(this.form);\n\t\treturn true;\n\t}\n\n\tasync onPageEnter(): Promise<boolean> {\n\t\tlet r1 = await this.populateServerDropdown();\n\t\tlet r2 = await this.populateDatabaseDropdown();\n\t\treturn r1 && r2;\n\t}\n\n\n\tasync onPageLeave(): Promise<boolean> {\n\t\tthis.appendFileExtensionIfNeeded();\n\t\treturn true;\n\t}\n\n\tpublic setupNavigationValidator() {\n\t\tthis.instance.registerNavigationValidator(() => {\n\t\t\tif (this.databaseLoader.loading) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t}\n\n\tprivate async createFileBrowser(): Promise<azdata.FormComponent> {\n\t\tthis.createFileBrowserParts();\n\n\t\t// default filepath\n\t\tthis.fileTextBox.value = this.generateFilePathFromDatabaseAndTimestamp();\n\t\tthis.model.filePath = this.fileTextBox.value;\n\n\t\tthis.fileButton.onDidClick(async (click) => {\n\t\t\tlet fileUri = await vscode.window.showSaveDialog(\n\t\t\t\t{\n\t\t\t\t\tdefaultUri: vscode.Uri.file(this.fileTextBox.value),\n\t\t\t\t\tsaveLabel: loc.save,\n\t\t\t\t\tfilters: {\n\t\t\t\t\t\t'bacpac Files': ['bacpac'],\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\n\t\t\tif (!fileUri) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.fileTextBox.value = fileUri.fsPath;\n\t\t\tthis.model.filePath = fileUri.fsPath;\n\t\t});\n\n\t\tthis.fileTextBox.onTextChanged(async () => {\n\t\t\tthis.model.filePath = this.fileTextBox.value;\n\t\t});\n\n\t\treturn {\n\t\t\tcomponent: this.fileTextBox,\n\t\t\ttitle: loc.fileLocation,\n\t\t\tactions: [this.fileButton]\n\t\t};\n\t}\n}\n"]}